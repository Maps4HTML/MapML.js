<!DOCTYPE html>
<html lang="en" dir="ltr" itemscope itemtype="http://schema.org/BlogPosting">
  <head>
    <!-- for the purposes of explaining stuff, force IE to compatibility mode -->
    <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" /> 
    <meta charset="utf-8" />
    <title>Progressive Web Maps</title>
    <link rel='icon' href='../MapsForHTML_16x16.png' sizes='16x16'>
    <meta name="description" content="Progressive Enhancement is the heart of the Web.  The Maps for HTML Community Group wants it to work for Web maps.">
    <meta name="keywords" content="maps,maps for html,web maps,image maps,html5,Web map demos,Web map examples,progressive web apps,web platform,progressive web maps,polymer,javascript,css3,service workers,offline,mobile">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta itemprop="name" content="Progressive Web Maps">
    <meta itemprop="description" content="Progressive Enhancement is the heart of the Web.  The Maps for HTML Community Group wants it to work for Web maps.">
    <meta itemprop="image" content="MapsForHTML.png">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@maps4html">
    <meta name="twitter:creator" content="@prushforth">
    <meta name="twitter:title" content="Progressive Web Maps">
    <meta name="twitter:description" content="Progressive Enhancement is the heart of the Web.  The Maps for HTML Community Group wants it to work for Web maps.">
    <meta name="twitter:image" content="http://maps4html.github.io/Web-Map-Custom-Element/map1.png">
    <meta name="twitter:image:alt" content="OpenStreetMap displayed by map custom element">
    
    <link rel="author" href="https://twitter.com/prushforth">
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,400italic,600,800|Source+Code+Pro" rel="stylesheet">
    <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>

    
    <!-- IE has been forced to IE7 compatibility (see above), Web Components aren't run -->
<!--[if !IE]>-->
    <script src="../bower_components/webcomponentsjs/webcomponents-lite.min.js"></script>

    <link rel="import" href="../web-map.html">
    <link rel="stylesheet" media="all" href="styles/v2-combined.css?20131111">

<!--<![endif]-->
    <style>
      /* map must have a defined height and width, can be set either by @height/@width or with css properties */
      .article map {
        height: 400px;
        width: 700px;
        max-width: 100%;
      }
      .transparency {
        opacity: 0.2;
      }
      area#line {
        fill: none; 
        stroke: purple; 
        stroke-width: 7px;
        stroke-opacity: 1.0;
        stroke-linecap: round;
      }
    </style>
  </head>
  <body  class="article tutorial">
  <header class="main" id="siteheader">
    <a href="#sitenav" id="navtoggle">Show navigation</a>

    
    <a id="toctoggle" href="#toc">Table of Contents</a>
    

    <nav id="sitenav">
      <ul>
        
        <li id="home_menu"><a href="." class="home">Home</a></li>
        
      </ul>
    </nav>

    
    <nav class="toc" id="toc">
      <h1>Table of Contents</h1>

      <ul>
                <li><a href='#toc-pe'>Progressive Enhancement</a></li>
                <li><a href='#toc-pwm'>Progressive Web Maps</a></li>
                <li><a href='#toc-show'>Show Me The Map!</a></li>
                <li><a href='#toc-extendedweb'>The Web, Extended</a></li>
                <li><a href='#toc-progress'>Further Progress</a></li>
      </ul>

    </nav>
    
  </header>    
    <div class="body-content">
      <section class="title">
        <section class="title-text container">
          <h1>Progressive Web Maps</h1>
          <h2>Customized Built-in &lt;map&gt; or Autonomous Custom &lt;web-map&gt; element?</h2>
          <a href="" class="watermark">Maps for HTML</a>
        </section>
      </section>
      
      <article class="content-wrapper">

        <section class="container">
          <div class="article-meta" id="article-meta">
            <nav class="toc">
              <h1>Table of Contents</h1>

              <ul>
                <li><a href='#toc-pe'>Progressive Enhancement</a></li>
                <li><a href='#toc-pwm'>Progressive Web Maps</a></li>
                <li><a href='#toc-show'>Show Me The Map!</a></li>
                <li><a href='#toc-extendedweb'>The Web, Extended</a></li>
                <li><a href='#toc-progress'>Further Progress</a></li>
              </ul>
            </nav>

          </div>
          <div class="content" id="article-content">

            <section class="byline">

              <div class="byline-content">
                <section class="author-images">
                  <a href="https://twitter.com/prushforth">
                    <img src="https://pbs.twimg.com/profile_images/477555139427848192/O077Dad0_400x400.png" itemprop="photo" alt="Peter Rushforth" title="Peter Rushforth">
                  </a>
                </section>
              </div>
            <section class="meta">
              <div class="authors">
                <strong>By</strong> <a href="https://twitter.com/prushforth">Peter Rushforth</a>
                
              </div>

              

              <div class="date">
                <time pubdate><strong>Published:</strong> 2016</time>
                
                <time class="updated"><strong>Updated:</strong> 2016</time>
                <span><strong>Comments:</strong> <a href="#wicg_thread" class="load-comments" data-wicg-identifier="https://discourse.wicg.io/c/web-mapping">0</a></span>
              </div>

              <div id="notcompatible" class="hidden">
                Your browser may not support the functionality in this article.
              </div>
            </section>
            <div class="clear"></div>
            </section>

          <h2 id="toc-pe">Progressive Enhancement</h2>
          <p><a href="https://gdstechnology.blog.gov.uk/2016/09/19/why-we-use-progressive-enhancement-to-build-gov-uk/">Progressive enhancement is a well-established practice</a>. The core idea behind it is layering: markup delivers the essential content, with behaviour built into the browser; stylesheets provide adaptability to individuals and devices, and script delivers the finally enhanced experience if all goes well.</p>
          <p>The layering principles behind progressive enhancement have spawned the notion of a Progressive Web App, in which certain features of mobile apps are layered on top of the essential user experience, to those browsers which support the advanced features.  Notably, script can be used to progressively enhance the network itself, and provide an offline experience if necessary.</p>
          <p>Similarly, progressive enhancement can also apply to the Web author experience.  HTML authors don‚Äôt start out as CSS gurus, nor as fully-fledged framework programmers.  We usually begin either as kids with a grade school homework assignment on how to create a Web page, or as curious adults who accidentally right-click on the View Source menu.  Either way, the experience of going from being a Web user to a Web author can be seen in the light of progressive enhancement: understanding what HTML elements do and how to use them, followed by understanding how they can be laid out and perhaps, if you become a programmer, enabling more sophisticated interactions with scripting.</p>
          <figure><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/f/fc/Mandel_zoom_08_satellite_antenna.jpg/640px-Mandel_zoom_08_satellite_antenna.jpg"><figcaption>Image credit: <i><a href="https://en.wikipedia.org/wiki/Benoit_Mandelbrot#Fractals_and_the_.22theory_of_roughness.22">Wikipedia</a></i></figcaption></figure>
          <p>Finally, progressive enhancement also applies to the Web Platform itself.  Over time, important capabilities have been added to the platform.  These capabilities have incrementally enabled the <a href="https://en.wikipedia.org/wiki/Separation_of_concerns">separation of concerns</a> that is the hallmark of good software design. Such separation is also at the heart of the Extensible Web movement: take the pressure off browsers to change behaviour by providing low level APIs that enable the platform to change itself. Evolution will continue to happen, but who knows what direction it will take? The <a href="https://briankardell.wordpress.com/2016/06/02/x-web-days-of-future-past/">JavaScript "X gene"</a> will <a href="https://briankardell.wordpress.com/2013/05/17/dropping-the-f-bomb/">allow the platform to experiment and hopefully settle</a> on the most <a href="https://twitter.com/RWD/status/536565318370725888">resilient</a> mutations.</p>
          <h2 id="toc-pwm">Progressive Web Maps</h2>
          <p>So, how does all this relate to Web maps?  On today‚Äôs Web, there is a major disconnect between <a href="https://www.google.com/maps/@45.3954162,-75.701995,15z?hl=en">the map experience that most or all of us are familiar with</a> and the sketchy foothold that the Web platform offers to maps as a concept. The disconnect lies in the fact that there is no progression between <a href="https://www.w3.org/TR/html/semantics-embedded-content.html#the-map-element">Web platform maps</a> and how maps are <a href="http://openlayers.org/">implemented</a> <a href="http://leafletjs.com/">today</a>.  </p>
          <figure><img src="https://assets.rbl.ms/842378/1216x700.jpg"><figcaption><p>Today's Web map authors bridge the gap. <i>Image credit: <a href="https://aciencianascoisas.com/2016/03/07/4-wild-pic-cabras-montanhosas">Science In Things</a></i></p></figcaption></figure>
          <p>The question is how to bridge the gap?  How can the platform afford HTML authors of all experiences and abilities the opportunity to create a modern Web map experience that is progressive?</p>
          <p>In the past, such a question had an all-or-nothing answer.  Either you use advanced features of the platform (scripting, WebGL, canvas, etc.), or you get nothing.  Such an approach is not progressive; it is more like (graceful) degradation. In order to be relevant today, a solution must be progressive and <a href="https://github.com/whatwg/html/issues/389">responsive</a>.</p>
          <p>Today‚Äôs answer is provided by evolving modern Web standards in the form of Custom Elements, which give us the opportunity to <a href="http://extensiblewebmanifesto.org/">extend the Web platform</a>.  </p>
          
          <h2 id="toc-show">Show Me The Map!</h2>
          <pre class="prettyprint">
          <code>
&lt;-- You will see the old image map behaviour if: --&gt;
&lt;-- * you're using an IE browser, this page should force IE7 mode --&gt;
&lt;-- * in FireFox, if Web Components are enabled, I believe the HTML import for the map custom element won't work --&gt;
&lt;-- * in any browser if you disable javascript --&gt;
&lt;-- else the map@is=web-map should have custom behaviour, including zoom, pan, layers, controls etc. --&gt;

&lt;-- The img element is only used for fallback processing, otherwise it is hidden by the custom element on load --&gt;
&lt;img usemap="#dowslake" src="map1.png" width="700" height="400" alt="Dow's Lake area" />

&lt;-- The map element can be set up by the HTML author to provide the old image map behaviour --&gt;
&lt;map name="dowslake" is="web-map" zoom="17" lat="45.398043" lon="-75.70683" width="700" height="400" controls hidden>
  &lt;layer- id="osm" src="http://geogratis.gc.ca/mapml/en/osmtile/osm/" label="Open Street Map" checked hidden>&lt;/layer-&gt;
  &lt;layer- id="marker" label="Marker layer" src="marker.mapml">&lt;/layer-&gt;
  &lt;area is="map-area" href='http://example.com/marker/' alt="Marker" coords="255,145,275,190" shape="rect" style="fill: none">
  &lt;area is="map-area" id="rect" href='http://example.com/rectangle/' alt="Rectangle" coords="345,290,415,320" shape="rect" style="fill: greenyellow; stroke: blue; stroke-width: 3px;fill-opacity: 0.4">
  &lt;area is="map-area" id="poly" href='http://example.com/polygon/' alt="Polygon" coords="392,116,430,100,441,128,405,145" shape="poly" style="fill: pink; stroke: blue; stroke-width: 3px;fill-opacity: 0.4">
  &lt;area is="map-area" id="line" href='http://example.com/line/' alt="Line" coords="275,275,540,107" shape="line">
  &lt;area is="map-area" id="donut" alt="Circle" href='http://example.com/circle/' coords="250,250,25" shape="circle" style="fill: white; stroke: aqua; stroke-width: 5px;fill-opacity: 0.0">
  &lt;area is="map-area" id="hole" coords="250,250,7" shape="circle" style="fill: blue; stroke: none;fill-opacity: 0.3;">
&lt;/map>
      </code>
      </pre>
      <!-- the @width / @height attributes take precedence over properties, but currently don't change to reflect updates -->
      <img usemap="#dowslake" src="../map1.png" width="700" height="400" alt="Dow's Lake area" />
      <map name="dowslake" is="web-map" zoom="17" lat="45.398043" lon="-75.70683" controls hidden>
        <layer- id="osm" src="http://geogratis.gc.ca/mapml/en/osmtile/osm/" label="Open Street Map" checked hidden></layer->
        <!-- the HTML author can create MapML files and serve them as layers if they prefer -->
        <layer- id="marker" label="Marker layer" src="marker.mapml"></layer->
        
        <area is="map-area" href='http://example.com/marker/' alt="Marker" coords="255,145,275,190" shape="rect" style="fill: none">
        <area is="map-area" id="rect" href='http://example.com/rectangle/' alt="Rectangle" coords="345,290,415,320" shape="rect" style="fill: greenyellow; stroke: blue; stroke-width: 3px;fill-opacity: 0.4">
        <area is="map-area" id="poly" href='http://example.com/polygon/' alt="Polygon" coords="392,116,430,100,441,128,405,145" shape="poly" style="fill: pink; stroke: blue; stroke-width: 3px;fill-opacity: 0.4">
        <area is="map-area" id="line" href='http://example.com/line/' alt="Line" coords="275,275,274,276,540,107,539,108,275,275" shape="poly" >

        <area is="map-area" id="donut" alt="Circle" href='http://example.com/circle/' coords="250,250,25" shape="circle" style="fill: white; stroke: aqua; stroke-width: 5px;fill-opacity: 0.0">
        <area is="map-area" id="hole" coords="250,250,7" shape="circle" style="fill: blue; stroke: none;fill-opacity: 0.3;">
      </map>
      <p>Here it is. You might like to load this page in different browsers or devices, or reload having disabled JavaScript, to get the idea of how it progresses and responds. It is a work in progress, so no promises are made. </p>
      <p>There are many detailed considerations to PE of the map element, and the Maps for HTML community seeks feedback with this post about what is best for web maps. Web Incubator Community <a href="https://discourse.wicg.io/c/web-mapping">feedback</a> would be greatly appreciated.</p>
          <h2 id="toc-extendedweb">The Web, Extended</h2>
          <p>There are two main design options for Custom Elements: extending the semantics of existing standard elements by with attributes and/or permitted content (a.k.a. customized built-in element e.g. &lt;button is=‚Äùtequila-button‚Äù>Drink me! &lt;/button>) or defining entirely new elements (a.k.a. autonomous elements e.g. &lt;taco-button>Eat me! &lt;/taco-button>). Although the barrier to doing the latter might seem lower at first glance, there is a <a href="http://www.brucelawson.co.uk/2014/on-the-accessibility-of-web-components-again/">school of thought</a> which <a href="http://html5doctor.com/on-html-belts-and-aria-braces/">suggests</a> that the former approach provides better value to the Web platform and progressive enhancement is its name.</p>
          <p>The <a href="https://www.w3.org/TR/2016/WD-custom-elements-20160226/#dev-advice">advice</a> of the Custom Elements spec is:</p>
          <blockquote>The simplest and most robust method to create custom elements that are usable and accessible is to implement custom elements as type extensions. This method provides a custom element with built in semantics and interaction behaviours that developers can use as a foundation.</blockquote>
          <p>If we, the Maps for HTML Community Group are successful, we will eventually have built, or caused to be built, a large set of Web sites which use our custom element(s), and it‚Äôs API. Ideally at that stage, browsers will agree that it makes sense for them to implement our element natively. If our element is 'autonomous', a new element (without the hyphen) will have to be minted and marketed, and all that portion of the Web which uses our element would have to be re-written to take advantage of the new reach. I suppose you might consider that a problem of success, but it also represents a barrier to adoption.</p>
          <p>A more viable solution will be to extend the behaviour of the HTML map element as demonstrated above.  Not only can the new functionality be layered appropriately for progressive enhancement, but at worst, HTML authors will have to remove the is=‚Äùweb-map‚Äù attribute from their markup to gain a ‚Äúnative‚Äù implementation; all selectors and code not based on the ‚Äúis‚Äù attribute should continue to work.  That‚Äôs the theory, at least; there is a lot of work to do to <a href="https://bocoup.com/weblog/extensible-web-manifesto">see this prollyfill through to completion</a>.</p>
          <h2 id="toc-progress">Further Progress</h2>
          <p>If creating a declarative Web map was the only goal, we would be essentially done now, because there are <a href="https://customelements.io/search/maps">many such Custom Elements today</a>. But a declarative Web map is only a starting point for progressive enhancement.  Although the beauty and sophistication of today‚Äôs Web maps can‚Äôt be accomplished without a lot of scripting magic, those maps really <i>are</i> beautiful and sophisticated.  The Web platform could provide a standard script API which enables enhancement from a common declarative starting point, and just as importantly, allows HTML (map) authors to progress from beginners to experts.</p>
          <p>Arguably, the central innovation of the Web platform is indirection through hypertext using URLs. This allows user agents to be coded in a domain-independent fashion, applicable across the Web.  It is also this aspect which underpins the type extension map element: maps and map content rely on URLs and media type semantics. The map type extension element also relies on this Web superpower.  This allows authors to easily include content from different map providers "interoperably". </p>
          <p>That‚Äôs where this community comes in.</p>
          <p>The Maps for HTML Community Group warmly invites the authors of google-map, here-map, leaflet-map, Leaflet.js, openlayers-map, OpenLayers.js, mapbox-map, carto-map, apple-map, etc., and yourself to <a href="https://www.w3.org/community/maps4html/">join us</a> to show your support, or even <a href="https://github.com/Maps4HTML">contribute</a> üòç. </p>
          <p>Comments are <a href="https://discourse.wicg.io/c/web-mapping">open</a>.</p>
          </div>
        </section>
      </article>
    </div>
  </body>
</html>
